<?xml version="1.0"?>
<terrainshader>
    <code>
        <![CDATA[
            #version 330
            #pragma vp_entryPoint "oe_flora_forestFloor_vert"
            #pragma vp_location   "vertex_view"
            vec2 oe_terrain_getCoordsAtLOD(in vec2 tc, in float lod);
            uniform float oe_flora_floorMaxDistance;
            uniform vec4 oe_layer_tilec;
            out float oe_forestfloor_mix;
            out vec2 oe_forestfloor_coords;
            void oe_flora_forestFloor_vert(inout vec4 view)
            {
                oe_forestfloor_mix = clamp(1.0 - (-view.z/oe_flora_floorMaxDistance), 0.0, 0.7);
                oe_forestfloor_coords = oe_terrain_getCoordsAtLOD(oe_layer_tilec.st, 20.0);
            }
        ]]>
    </code>
    <code>
        <![CDATA[
            #version 330
            #pragma vp_entryPoint "oe_flora_forestFloor_frag"
            #pragma vp_location   "fragment"
            uniform sampler2D oe_flora_floorTex;
            uniform vec4 oe_tile_key;
            vec4 oe_layer_tilec;
            in float oe_forestfloor_mix;
            in vec2 oe_forestfloor_coords;
            void oe_flora_forestFloor_frag(inout vec4 color)
            {
                if ( oe_tile_key.z >= 14 ) {
                    vec3 texel = texture(oe_flora_floorTex, oe_forestfloor_coords).rgb;
                    color.rgb = mix(color.rgb, texel, oe_forestfloor_mix);
                }
            }
        ]]>
    </code>
    
    <sampler name="oe_flora_floorTex" url="forest_floor2.jpg"/>
    
    <uniform name="oe_flora_floorMaxDistance" value="6400.0" />
    
</terrainshader>